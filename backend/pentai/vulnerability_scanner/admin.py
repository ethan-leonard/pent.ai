from django.contrib import admin
from .models import Vulnerability

@admin.register(Vulnerability)
class VulnerabilityAdmin(admin.ModelAdmin):
    list_display = ['name', 'risk', 'confidence', 'url', 'param', 'method']
    list_filter = ['risk', 'confidence', 'method']
    search_fields = ['name', 'description', 'url', 'param', 'attack', 'evidence']
    
    fieldsets = (
        ('Basic Information', {
            'fields': ('name', 'description', 'url', 'risk', 'confidence')
        }),
        ('Vulnerability Details', {
            'fields': ('param', 'attack', 'solution')
        }),
        ('Technical Details', {
            'fields': ('method', 'evidence', 'plugin_id', 'cweid', 'input_vector', 'alert_id'),
            'classes': ('collapse',)
        }),
        ('Reference Information', {
            'fields': ('reference',),
            'classes': ('collapse',)
        }),
    )
    
    readonly_fields = ('alert_id',)